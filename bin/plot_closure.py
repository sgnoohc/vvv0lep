#!/bin/env python3

import plottery_wrapper as p
import plot_config as c
from systematics import systs

signal_scale = 1

histxaxislabeloptions = {
        "D01"         : {"xaxis_label" : "D01"                           , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": False},
        "D012"        : {"xaxis_label" : "D012"                          , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": False},
        "SR3SumPtFJ"  : {"xaxis_label" : "H_{T,Fat-Jet} [GeV]"           , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "SR2SumPtFJ"  : {"xaxis_label" : "H_{T,Fat-Jet} [GeV]"           , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "ZL3FJA__SR1SumPtFJ"  : {"xaxis_label" : "#Sigma p_{T,Fat-Jet} [GeV]"    , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "SR1SumPtFJ"  : {"xaxis_label" : "#Sigma p_{T,Fat-Jet} [GeV]"    , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "SumPtFJFit"  : {"xaxis_label" : "H_{T,Fat-Jet} [GeV]"           , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "HT_binned"   : {"xaxis_label" : "H_{T} [GeV]"                   , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "HTJ_binned"  : {"xaxis_label" : "H_{T} [GeV]"                   , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "ZL2FJA__HTFJ_binned" : {"xaxis_label" : "H_{T} [GeV]"                   , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "ZL2FJA__HTFJFit2" : {"xaxis_label" : "H_{T} [GeV]"                   , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "HTFJ_binned" : {"xaxis_label" : "H_{T} [GeV]"                   , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "HT"          : {"xaxis_label" : "H_{T} [GeV]"                   , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "SR1HTFJ"     : {"xaxis_label" : "H_{T,Fat-Jet,MET} [GeV]"       , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "SR2HTFJ"     : {"xaxis_label" : "H_{T,Fat-Jet,MET} [GeV]"       , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "SR1HT"       : {"xaxis_label" : "H_{T,Fat-Jet,MET} [GeV]"       , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "SR2HT"       : {"xaxis_label" : "H_{T,Fat-Jet,MET} [GeV]"       , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "HTFJ"        : {"xaxis_label" : "H_{T,Fat-Jet,MET} [GeV]"       , "xaxis_ndivisions" : 505, "nbins": 10, "signal_scale": signal_scale, "yaxis_log": True , "divide_by_bin_width": False},
        "SumPtFJ"     : {"xaxis_label" : "#Sigma p_{T,Fat-Jet} [GeV]"    , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True },
        "SumPtJ"      : {"xaxis_label" : "H_{T,AK4Jet} [GeV]"            , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True },
        "VMD0"        : {"xaxis_label" : "V_{MD,lead}"                   , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale": signal_scale, "yaxis_log": False},
        "VMD1"        : {"xaxis_label" : "V_{MD,sublead}"                , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale": signal_scale, "yaxis_log": False},
        "MinVMD1"     : {"xaxis_label" : "V_{MD,sublead}"                , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale": signal_scale, "yaxis_log": False},
        "MinVMD2"     : {"xaxis_label" : "V_{MD,sublead}"                , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale": signal_scale, "yaxis_log": False},
        "VMD2"        : {"xaxis_label" : "V_{MD,trail}"                  , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale": signal_scale, "yaxis_log": False},
        "WMD0"        : {"xaxis_label" : "W_{MD,lead}"                   , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": False},
        "WMD1"        : {"xaxis_label" : "W_{MD,sublead}"                , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": False},
        "Pt01"        : {"xaxis_label" : "p_{T,01} [GeV]"                , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True },
        "Pt0"         : {"xaxis_label" : "p_{T,lead} [GeV]"              , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True },
        "Pt1"         : {"xaxis_label" : "p_{T,sublead} [GeV]"           , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True },
        "Pt2"         : {"xaxis_label" : "p_{T,trail} [GeV]"             , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": False},
        "Mass0"       : {"xaxis_label" : "M_{lead} [GeV]"                , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale": signal_scale, "yaxis_log": False},
        "Mass1"       : {"xaxis_label" : "M_{sublead} [GeV]"             , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale": signal_scale, "yaxis_log": False},
        "Mass2"       : {"xaxis_label" : "M_{trail} [GeV]"               , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale": signal_scale, "yaxis_log": False},
        "Mass01"      : {"xaxis_label" : "M_{01} [GeV]"                  , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True },
        "Mass02"      : {"xaxis_label" : "M_{02} [GeV]"                  , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": False},
        "Mass12"      : {"xaxis_label" : "M_{12} [GeV]"                  , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": False},
        "DPhi01"      : {"xaxis_label" : "#Delta#phi_{01}"               , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True },
        "DPhi02"      : {"xaxis_label" : "#Delta#phi_{02}"               , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": False},
        "DPhi12"      : {"xaxis_label" : "#Delta#phi_{12}"               , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": False},
        "NbLoose"     : {"xaxis_label" : "NbLoose"                       , "xaxis_ndivisions" : 505, "nbins": 7 , "signal_scale": signal_scale, "yaxis_log": True },
        "NbMedium"    : {"xaxis_label" : "NbMedium"                      , "xaxis_ndivisions" : 505, "nbins": 7 , "signal_scale": signal_scale, "yaxis_log": True },
        "NbTight"     : {"xaxis_label" : "NbTight"                       , "xaxis_ndivisions" : 505, "nbins": 7 , "signal_scale": signal_scale, "yaxis_log": True },
        "NoORNbLoose" : {"xaxis_label" : "NoORNbLoose"                   , "xaxis_ndivisions" : 505, "nbins": 7 , "signal_scale": signal_scale, "yaxis_log": True },
        "NoORNbMedium": {"xaxis_label" : "NoORNbMedium"                  , "xaxis_ndivisions" : 505, "nbins": 7 , "signal_scale": signal_scale, "yaxis_log": True },
        "NoORNbTight" : {"xaxis_label" : "NoORNbTight"                   , "xaxis_ndivisions" : 505, "nbins": 7 , "signal_scale": signal_scale, "yaxis_log": True },
        "MVVX"        : {"xaxis_label" : "M_{VVX} [GeV]"                 , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True },
        "MET"         : {"xaxis_label" : "MET [GeV]"                     , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True },
        "SRMET"       : {"xaxis_label" : "MET [GeV]"                     , "xaxis_ndivisions" : 505, "nbins": 20, "signal_scale": signal_scale, "yaxis_log": True },
        "Yield"       : {"xaxis_label" : "Yield"                         , "xaxis_ndivisions" : 505, "nbins": 50, "signal_scale": signal_scale, "yaxis_log": False},
        "Cutflow3FJ"  : {"xaxis_label" : "Cutflow"                       , "xaxis_ndivisions" : 505, "nbins": 50, "signal_scale": signal_scale, "yaxis_log": False},
        "Cutflow2FJ"  : {"xaxis_label" : "Cutflow"                       , "xaxis_ndivisions" : 505, "nbins": 50, "signal_scale": signal_scale, "yaxis_log": False},
        "ZL2FJPresel__VMD0"  : {"xaxis_label" : "V_{MD,lead}"            , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale":         4500, "yaxis_log": False, "blind": True },
        "ZL2FJPresel__Mass0" : {"xaxis_label" : "M_{lead} [GeV]"         , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale":         4500, "yaxis_log": False, "blind": True },
        "ZL2FJPresel__Mass1" : {"xaxis_label" : "M_{sublead} [GeV]"      , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale":         4500, "yaxis_log": False, "blind": True },
        "ZL3FJPresel__Mass0" : {"xaxis_label" : "M_{lead} [GeV]"         , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale":         1500, "yaxis_log": False, "blind": True },
        "ZL3FJPresel__Mass1" : {"xaxis_label" : "M_{sublead} [GeV]"      , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale":         1500, "yaxis_log": False, "blind": True },
        "ZL3FJPresel__Mass2" : {"xaxis_label" : "M_{trail} [GeV]"        , "xaxis_ndivisions" : 505, "nbins": 60, "signal_scale":         1500, "yaxis_log": False, "blind": True },
        }


p.dump_plot(
        fnames = [f"{c.mdir}/qcd.root"],
        data_fname = f"{c.mdir}/qcd_closure.root",
        filter_pattern = "ZL2FJA__HTFJFit2,ZL2FJA__HTFJ_binned,ZL2FJE__HTFJ_binned,ZL3FJA__SR1SumPtFJ,ZL3FJE__SR1SumPtFJ,ZL3FJA__SumPtFJFit,ZL3FJA__SumPtFJZoom",
        dirname = f"plots/ZL/{c.tag}/dim6/closure",
        legend_labels = ["QCD MC"],
        extraoptions = {
            "nbins": 20,
            "legend_datalabel": "QCD Predict",
            "ratio_range": [0., 2],
            "yaxis_range": [0.001, 1e7],
            "yaxis_log": True,
            "lumi_value": 137,
            "print_yield": True,
            "yield_prec": 3,
            },
            histxaxislabeloptions = histxaxislabeloptions,
        )

# p.dump_plot(
#         fnames = [f"{c.mdir}/qcd.root"],
#         # data_fname = f"{c.mdir}/qcd_closure.root",
#         filter_pattern = "ZL2FJA__HTFJFit,ZL2FJB__HTFJFit,ZL2FJC__HTFJFit,ZL2FJD__HTFJFit",
#         dirname = f"plots/ZL/{c.tag}/dim6/closure",
#         legend_labels = ["QCD MC"],
#         extraoptions = {
#             "nbins": 30,
#             "legend_datalabel": "QCD Predict",
#             "ratio_range": [0., 2],
#             "yaxis_range": [0.001, 1e7],
#             "yaxis_log": True,
#             "lumi_value": 137,
#             "print_yield": True,
#             "yield_prec": 3,
#             },
#         )
